<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Resultado do Teste de Prosperidade</title>
    
    <!-- Meta Tags -->
    <meta name="description" id="pageDescription" content="Descubra sua energia predominante no Teste de Prosperidade">
    <meta property="og:title" id="ogTitle" content="Resultado do Teste de Prosperidade">
    <meta property="og:description" id="ogDescription" content="Descubra sua energia predominante">
    <meta property="og:image" content="https://raw.githubusercontent.com/renatoambrosi/quizresultado/main/assets/images/Logo%20Suellen.png">
    
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            min-height: 100vh;
            position: relative;
        }

        /* Fundo da página com transparência */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://raw.githubusercontent.com/renatoambrosi/quizresultado/main/assets/images/Suellen%20fundo.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            opacity: 0.3;
            z-index: -2;
        }

        /* Overlay para melhorar legibilidade */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            z-index: -1;
        }

        /* Header com imagem do GitHub */
        .header {
            background-image: url('https://raw.githubusercontent.com/renatoambrosi/quizresultado/main/assets/images/Teste%20Prosperidade%20Header.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding: 30px 0;
            text-align: center;
            position: relative;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Logo no header */
        .header .logo {
            position: relative;
            z-index: 10;
        }

        .header .logo img {
            height: 60px;
            width: auto;
            filter: drop-shadow(0 2px 8px rgba(0,0,0,0.3));
        }

        /* Container principal */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            min-height: calc(100vh - 120px);
        }

        /* Títulos */
        .main-title {
            font-size: 36px;
            font-weight: 400;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: left;
        }

        .subtitle {
            font-size: 20px;
            color: #555;
            margin-bottom: 15px;
            text-align: left;
        }

        .energy-highlight {
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 40px;
            text-align: left;
        }

        /* Painel de percentuais simples */
        .percentages-panel {
            margin: 40px 0;
            background: transparent;
        }

        .percentage-item {
            font-size: 18px;
            color: #333;
            margin-bottom: 8px;
            padding: 5px 0;
        }

        /* Botões */
        .share-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-share {
            background: #25d366;
            color: white;
        }

        .btn-share:hover {
            background: #128c7e;
            transform: translateY(-2px);
        }

        .btn-pdf {
            background: #dc3545;
            color: white;
        }

        .btn-pdf:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        /* Vídeo */
        .video-container {
            margin: 50px 0;
            text-align: center;
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Narrativa */
        .narrative {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            margin: 40px 0;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            line-height: 1.8;
        }

        .narrative h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 28px;
            font-weight: 600;
        }

        .narrative p {
            margin-bottom: 20px;
            color: #555;
            font-size: 16px;
        }

        .narrative strong {
            color: #2c3e50;
            font-weight: 600;
        }

        .narrative em {
            color: #666;
            font-style: italic;
        }

        /* CTA dos cursos com imagens do GitHub */
        .course-cta {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            margin: 50px 0;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .course-image {
            flex: 0 0 200px;
        }

        .course-image img {
            width: 100%;
            height: auto;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .course-content {
            flex: 1;
            text-align: left;
        }

        .course-cta h3 {
            font-size: 28px;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .course-cta p {
            font-size: 18px;
            margin-bottom: 25px;
            color: #555;
            line-height: 1.6;
        }

        .btn-course {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 18px 40px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 30px;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-course:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
            color: white;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 100px 20px;
            background: rgba(255, 255, 255, 0.9);
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error */
        .error {
            background: rgba(248, 215, 218, 0.9);
            color: #721c24;
            padding: 30px;
            border-radius: 15px;
            margin: 40px 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .hidden {
            display: none;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            border-top: 1px solid rgba(0,0,0,0.1);
            margin-top: 50px;
            background: rgba(255, 255, 255, 0.5);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                background-position: center top;
                min-height: 100px;
                padding: 20px 0;
            }
            
            .header .logo img {
                height: 50px;
            }
            
            .container {
                padding: 30px 20px;
            }
            
            .main-title {
                font-size: 28px;
            }
            
            .energy-highlight {
                font-size: 24px;
            }
            
            .course-cta {
                flex-direction: column;
                text-align: center;
            }
            
            .course-image {
                flex: none;
            }
            
            .course-content {
                text-align: center;
            }
            
            .share-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 250px;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            body::before {
                background-attachment: scroll;
            }
            
            .container {
                padding: 20px 15px;
            }
            
            .main-title {
                font-size: 24px;
            }
            
            .course-cta {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header com imagem do GitHub -->
    <div class="header">
        <div class="logo">
            <img src="https://raw.githubusercontent.com/renatoambrosi/quizresultado/main/assets/images/Logo%20Suellen.png" alt="Suellen Seragi" id="headerLogo">
        </div>
    </div>

    <!-- Loading State -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <h3>Carregando seu resultado...</h3>
        <p>Aguarde enquanto processamos suas respostas</p>
    </div>

    <!-- Error State -->
    <div id="error" class="error hidden">
        <h3>Ops! Algo deu errado</h3>
        <p id="errorMessage">Não foi possível carregar seu resultado. Tente novamente.</p>
        <button onclick="location.reload()" class="btn btn-share" style="margin-top: 20px;">
            🔄 Tentar Novamente
        </button>
    </div>

    <!-- Main Content -->
    <div id="content" class="container hidden">
        <!-- Título principal -->
        <h1 class="main-title" id="mainTitle">Resultado Teste de Prosperidade</h1>
        
        <!-- Subtitle -->
        <p class="subtitle">A sua energia predominante é:</p>

        <!-- Energy Highlight -->
        <div class="energy-highlight" id="energyHighlight">
            Carregando...
        </div>

        <!-- Percentages Panel -->
        <div class="percentages-panel" id="percentagesPanel">
            <!-- Será preenchido via JavaScript -->
        </div>

        <!-- Pergunta motivacional -->
        <p style="font-size: 20px; color: #555; margin: 40px 0 30px 0;">E agora o que devo fazer?</p>

        <!-- Share Buttons -->
        <div class="share-buttons">
            <button onclick="shareResult()" class="btn btn-share">
                📱 Compartilhar meu resultado
            </button>
            <button onclick="generatePDF()" class="btn btn-pdf">
                📄 Baixar PDF
            </button>
        </div>

        <!-- Video -->
        <div class="video-container">
            <div class="video-wrapper">
                <iframe id="video" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
            </div>
        </div>

        <!-- Narrative -->
        <div class="narrative" id="narrative">
            <!-- Conteúdo será inserido via JavaScript -->
        </div>

        <!-- Action Buttons -->
        <div class="share-buttons">
            <button onclick="shareTest()" class="btn btn-share">
                🎯 Compartilhar este teste
            </button>
        </div>

        <!-- Course CTA com imagens do GitHub -->
        <div class="course-cta" id="courseCTA">
            <!-- Conteúdo será inserido via JavaScript -->
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>© 2024 Suellen Seragi - Teste de Prosperidade</strong></p>
            <p>Desenvolvido com ❤️ para transformar vidas</p>
        </div>
    </div>

    <script>
        // Configurações
        const CONFIG = {
            apiUrl: 'https://script.google.com/macros/s/AKfycbz5h1hVNQgbojYu1SXYiYotkUKkdcEh7ZqmgtOsN5XX3lwc/exec',
            videoUrl: 'https://www.youtube.com/embed/SEU_VIDEO_ID',
            testUrl: 'https://quizfront.vercel.app',
            imagesPath: 'https://raw.githubusercontent.com/renatoambrosi/quizresultado/main/assets/images/'
        };

        // Dados das energias com narrativas dos documentos
        const ENERGY_DATA = {
            'medo': {
                title: 'Energia do Medo',
                course: 'ouro',
                narrative: `
                    <h2>ENERGIA DO MEDO</h2>
                    <p>Muitos me falam que se sentem como se vivessem com o freio de mão puxado. Como se tivesse uma barreira invisível que impedisse de romper na vida. Pelo seu resultado no teste, você se sente assim, não é?</p>
                    <p>Tenta avançar, tenta mudar... mas não consegue e parece que sempre tem algo dentro que sempre fala: <strong>"E se der errado?"</strong></p>
                    <p>Você não chama isso de medo. Às vezes diz que é "bom senso", entende como ver a realidade, às vezes se convence de que é só prudência e responsabilidade. Mas no fundo, o medo está dirigindo sua vida. Silenciosamente e constantemente.</p>
                    <p>Sabe o que é pior? Ele não chega gritando. Chega como dúvida. Como aquela sensação de que agora não é o momento. Como aquela desculpa que parece sensata, mas te prende no mesmo lugar de sempre.</p>
                    <p><em>"Aquilo que temo me sobrevém." - Jó 3:25 (NVI)</em></p>
                    <p>Você pode até estar vivendo uma vida sem grandes tragédias. Mas se for honesto... também não está colhendo grandes frutos, é ou não é?</p>
                    <p>Porque o medo — mesmo disfarçado de lógica racional — rouba exatamente o que a prosperidade precisa para florescer: visão, ação e confiança.</p>
                `
            },
            'desordem': {
                title: 'Energia da Desordem',
                course: 'ouro',
                narrative: `
                    <h2>ENERGIA DA DESORDEM</h2>
                    <p>A sensação é que você está sempre acelerado. Tentando resolver isso e aquilo, correndo pra não esquecer nada, ou pra não atrasar ainda mais. Sempre em dúvida se fez o bastante.</p>
                    <p>Mas no fundo, você sabe: <strong>você não está no controle — está só apagando incêndio.</strong></p>
                    <p>Essa é a marca da energia da desordem: <strong>Age muito, mas é pouco eficaz. Faz muito mas parece ter pouco resultado.</strong></p>
                    <p>Sua mente não para, seu dia não rende, sua paz não chega. Você vive ocupado... mas os resultados não acompanham.</p>
                    <p>Não é que você não tenha capacidade. Você tem. O problema é que a energia que te move é confusa, fragmentada, sem foco.</p>
                    <p>Você age sob pressão, toma decisões reativas, e no fim das contas, tem a sensação constante de estar atrasado na própria vida, é ou não é?</p>
                    <p><em>"Portanto, tudo deve ser feito com ordem e de maneira correta." - 1 Coríntios 14:40 (NTLH)</em></p>
                    <p>A prosperidade até tenta se manifestar na sua vida, mas encontra um terreno instável e confuso, emocionalmente poluído e cheio de ruídos e barulho, muito barulho.</p>
                `
            },
            'validacao': {
                title: 'Energia da Validação',
                course: 'ouro',
                narrative: `
                    <h2>ENERGIA DA VALIDAÇÃO</h2>
                    <p><strong>Você cresceu com um desejo sincero:</strong> ser amado. Ser notado. Ser importante pra alguém. Mas o que encontrou foram respostas frias, repreensões constrangedoras, comparações que machucavam, e tentativas de acertar que sempre pareciam pequenas demais.</p>
                    <p>É como se, por mais que você fizesse, nunca fosse o bastante.</p>
                    <p>Você queria pertencer, ser apreciado. Queria ser abraçado quando errasse. Elogiado quando tentava se expressar. Queria que alguém olhasse pra você e dissesse: <strong>"Você tem valor, e é importante."</strong></p>
                    <p>Mas isso nunca veio. Veio o contrário: O presente ignorado, a entrega que virou piada, nunca se sentiu bem-vindo, o esforço que não gerou admiração — só cobrança, o coração bom que só recebia esporro, se sentia invisível.</p>
                    <p>E o sentimento cruel de estar sempre errado, inadequado — Pensando errado. Fazendo errado. Até quando fazia o máximo para dar seu melhor, parecia bobo aos olhos dos outros.</p>
                    <p><em>"Mesmo que meu pai e minha mãe me abandonem, o Senhor cuidará de mim." - Salmo 27:10 (NTLH)</em></p>
                    <p><em>"Visto que és precioso aos meus olhos, digno de honra, e eu te amo..." - Isaías 43:4 (ARA)</em></p>
                    <p>E o que Ele vê... não é fracasso. É um coração que sempre quis acertar. Mesmo sem amor. Mesmo sem colo. Mesmo sem aplauso.</p>
                `
            },
            'autossuficiencia': {
                title: 'Energia da Autossuficiência',
                course: 'lei',
                narrative: `
                    <h2>ENERGIA DA AUTOSSUFICIÊNCIA</h2>
                    <p>Você aprendeu a se virar sozinho. Na falta de apoio, desenvolveu soluções. Na ausência de direção, criou o próprio caminho. Na dor, virou força.</p>
                    <p>E isso não é pouca coisa. Foi o que te fez resistir quando muitos teriam parado.</p>
                    <p>Mas agora você sente o peso de ter que ser forte o tempo todo. E no fundo, sabe que essa independência virou um escudo. Um mecanismo. Uma armadura que te protege — mas também te isola.</p>
                    <p>A energia da autossuficiência não impede que você prospere financeiramente, mas ela faz você prosperar <strong>do jeito mais cansativo possível</strong>.</p>
                    <p>Você tem que pensar por todos. Decidir por todos. Executar por todos. Você até tenta confiar... Mas se algo sai do controle, já pensa: "Deixa que eu resolvo".</p>
                    <p>Você se cobra mais do que deveria, ajuda mais do que aguenta, e recebe menos do que merece. E às vezes, mesmo no meio das conquistas, sente um vazio que não faz sentido.</p>
                    <p><em>"Confie no Senhor de todo o seu coração e não se apoie em seu próprio entendimento." - Provérbios 3:5 (NVI)</em></p>
                    <p>A verdadeira força não está em controlar tudo. Está em saber em quem você se apoia quando solta o controle: em Deus. Você não está sozinho.</p>
                `
            },
            'prosperidade-1': {
                title: 'Energia da Prosperidade',
                course: 'ouro',
                narrative: `
                    <h2>ENERGIA DA PROSPERIDADE - Nível 1</h2>
                    <p>Você está no caminho certo! O fato de ter uma porcentagem de prosperidade maior que as outras em seu resultado, já indica que uma semente poderosa foi plantada em você.</p>
                    <p>Existe uma intuição, uma busca por algo maior, que te move. Você não se contenta com o "freio de mão puxado" e busca ativamente uma vida mais plena e sustentável.</p>
                    <p>No entanto, é natural que, com energia de prosperidade nível 1, você ainda sinta a influência de outras energias que podem estar te segurando. Talvez o medo ainda sussurre dúvidas, a desordem traga alguma confusão, a autossuficiência te impeça de pedir ajuda, ou a busca por validação externa te desvie do seu próprio valor.</p>
                    <p>Essa é uma fase de reconhecimento e de ajustes. Você já tem a direção, mas precisa fortalecer os passos. A prosperidade para você, é um potencial latente que precisa ser nutrido com consciência e intenção.</p>
                    <p><em>"Porque a vereda dos justos é como a luz da aurora, que vai brilhando mais e mais até ser dia perfeito." - Provérbios 4:18 (NVI)</em></p>
                    <p>Sua luz já começou a brilhar. O desafio agora é não permitir que os resquícios das outras energias a ofusquem.</p>
                `
            },
            'prosperidade-2': {
                title: 'Energia da Prosperidade',
                course: 'lei',
                narrative: `
                    <h2>ENERGIA DA PROSPERIDADE - Nível 2</h2>
                    <p>Você está em um ponto de virada poderoso! Com esse nível de energia da prosperidade, você já demonstrou uma capacidade notável de transcender as limitações das outras energias.</p>
                    <p>Você não apenas vislumbra a prosperidade, mas já a experimenta de forma consistente em diversas áreas da sua vida. Há uma clareza crescente sobre o que realmente importa e uma habilidade de se alinhar com seus valores mais profundos.</p>
                    <p>Nesse nível, as outras energias (medo, desordem, autossuficiência, validação) não te paralisam mais, mas podem surgir como "testes" e tentações, tentando desviar seu foco ou atrasar seu progresso.</p>
                    <p>Esta é uma fase de consolidação e expansão. Você já construiu uma base sólida e agora está pronto para acelerar o seu crescimento. É como ter um mapa, conhecer melhor o destino e já ter percorrido boa parte do caminho.</p>
                    <p><em>"Mas os que esperam no Senhor renovarão as suas forças. Voarão alto como águias; correrão e não ficarão exaustos, andarão e não se fatigarão." - Isaías 40:31 (NVI)</em></p>
                    <p>Sua força já é grande, mas a verdadeira sabedoria está em saber quando agir e quando esperar, confiando no processo.</p>
                `
            },
            'prosperidade-3': {
                title: 'Energia da Prosperidade',
                course: 'lei',
                narrative: `
                    <h2>ENERGIA DA PROSPERIDADE - Nível 3</h2>
                    <p>Existe algo diferente em você. Não é pressa. Não é desespero. É uma firmeza interna que, mesmo quando tudo parece incerto, te mantém no eixo.</p>
                    <p>Você já entendeu que prosperidade não é sobre ter muito, nem sobre parecer bem. É sobre estar pleno, se sentir completo. É sobre saber que está no caminho certo — mesmo quando ainda falta chão.</p>
                    <p>Essa é a energia da prosperidade: a confiança madura de quem plantou com consciência, está regando com disciplina, e sabe esperar o tempo da colheita, descansando e confiando em Deus.</p>
                    <p>Você já não corre atrás. Você atrai. Você constrói. Você sustenta com paz. Você vive no fluxo do rio, onde as coisas acontecem no tempo certo, sem forçar a barra. E tudo isso é real.</p>
                    <p><em>"Bem-aventurado o homem que não anda segundo o conselho dos ímpios... Pois será como a árvore plantada junto a ribeiros de águas, a qual dá o seu fruto no seu tempo; as suas folhas não caem, e tudo quanto fizer prosperará." - Salmo 1:1-3 (ARC)</em></p>
                    <p><strong>Parabéns por ter chegado até aqui na sua vida! Continue "combatendo o bom combate, completando a carreira, e sempre guardando a sua fé".</strong></p>
                `
            }
        };

        const COURSES = {
            ouro: {
                title: 'O Ouro da Reprogramação Mental',
                description: 'Transforme sua mente e destrave sua prosperidade com ferramentas práticas e fundamentadas na fé.',
                url: 'https://pay.hotmart.com/seu-link-ouro',
                image: 'O%20Ouro%20Web.jpg'
            },
            lei: {
                title: 'Lei da Atração Bíblica',
                description: 'Descubra como alinhar fé e ação para atrair abundância de forma sustentável e próspera.',
                url: 'https://pay.hotmart.com/seu-link-lei',
                image: 'Lei%20da%20Atracao%20Editavel%20Web.jpg'
            }
        };

        // Estado global
        let currentUID = null;
        let currentData = null;
        let currentResult = null;

        // Inicialização
        window.addEventListener('DOMContentLoaded', init);

        function init() {
            currentUID = getUIDFromURL();
            
            if (!currentUID) {
                showError('UID não encontrado na URL. Acesse através do link enviado por email.');
                return;
            }

            loadResult();
        }

        function getUIDFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('uid');
        }

        async function loadResult() {
            try {
                showLoading();
                
                const response = await fetch(`${CONFIG.apiUrl}?uid=${currentUID}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (!data.respostas || !Array.isArray(data.respostas)) {
                    throw new Error('Dados de resposta inválidos ou ausentes');
                }
                
                if (data.respostas.length !== 30) {
                    console.warn(`Esperado 30 respostas, encontrado ${data.respostas.length}`);
                }
                
                currentData = data;
                currentResult = calculateResult(data.respostas);
                
                displayResult();
                hideLoading();
                
            } catch (error) {
                console.error('Erro ao carregar resultado:', error);
                showError(`Não foi possível carregar seu resultado. ${error.message}`);
            }
        }

        function calculateResult(respostas) {
            // Contadores para cada energia
            const energias = {
                medo: 0,
                desordem: 0,
                autossuficiencia: 0,
                validacao: 0,
                prosperidade: 0
            };

            // Mapeamento das respostas A, B, C, D, E para energias
            const answerMap = {
                'A': 'medo',
                'B': 'desordem',
                'C': 'autossuficiencia',
                'D': 'validacao',
                'E': 'prosperidade'
            };

            // Contar respostas por energia
            respostas.forEach(resposta => {
                const energy = answerMap[resposta.toUpperCase()];
                if (energy && energias.hasOwnProperty(energy)) {
                    energias[energy]++;
                } else {
                    console.warn(`Resposta inválida encontrada: ${resposta}`);
                }
            });

            // Calcular percentuais
            const total = respostas.length;
            const percentages = {};
            
            Object.keys(energias).forEach(energy => {
                percentages[energy] = total > 0 ? Math.round((energias[energy] / total) * 100) : 0;
            });

            // Encontrar energia predominante
            let predominant = 'prosperidade';
            let maxCount = energias.prosperidade;

            Object.keys(energias).forEach(energy => {
                if (energias[energy] > maxCount) {
                    maxCount = energias[energy];
                    predominant = energy;
                }
            });

            // Determinar nível da prosperidade (se for predominante)
            let energyKey = predominant;
            if (predominant === 'prosperidade') {
                const prosperidadePercent = percentages.prosperidade;
                if (prosperidadePercent >= 75) {
                    energyKey = 'prosperidade-3';
                } else if (prosperidadePercent >= 50) {
                    energyKey = 'prosperidade-2';
                } else {
                    energyKey = 'prosperidade-1';
                }
            }

            return {
                percentages,
                predominant,
                energyKey,
                energyData: ENERGY_DATA[energyKey],
                counts: energias,
                total: total
            };
        }

        function displayResult() {
            const { percentages, energyData } = currentResult;
            const userName = currentData.nome || '';
            
            // Atualizar título da página
            const title = userName ? 
                `Resultado do Teste de Prosperidade de ${userName}` : 
                'Resultado Teste de Prosperidade';
            
            document.getElementById('mainTitle').textContent = title;
            document.getElementById('pageTitle').textContent = title;
            
            // Atualizar meta tags para compartilhamento
            updateMetaTags(title, energyData.title);
            
            // Mostrar energia predominante
            document.getElementById('energyHighlight').textContent = energyData.title;
            
            // Mostrar percentuais
            displayPercentages(percentages);
            
            // Carregar vídeo (substitua pela URL real)
            document.getElementById('video').src = CONFIG.videoUrl;
            
            // Mostrar narrativa específica
            document.getElementById('narrative').innerHTML = energyData.narrative;
            
            // Mostrar CTA do curso
            displayCourseCTA(energyData.course);
            
            // Mostrar conteúdo principal
            document.getElementById('content').classList.remove('hidden');
        }

        function displayPercentages(percentages) {
            const panel = document.getElementById('percentagesPanel');
            const energyLabels = {
                prosperidade: 'Energia da Prosperidade',
                medo: 'Energia do Medo',
                autossuficiencia: 'Energia da Autossuficiência',
                desordem: 'Energia da Desordem',
                validacao: 'Energia da Validação'
            };
            
            let html = '';
            Object.entries(energyLabels).forEach(([key, label]) => {
                const percent = percentages[key] || 0;
                html += `<div class="percentage-item">${label}: ${percent}%</div>`;
            });
            
            panel.innerHTML = html;
        }

        function displayCourseCTA(courseType) {
            const course = COURSES[courseType];
            if (!course) return;
            
            const cta = document.getElementById('courseCTA');
            cta.innerHTML = `
                <div class="course-image">
                    <img src="${CONFIG.imagesPath}${course.image}" alt="${course.title}" loading="lazy">
                </div>
                <div class="course-content">
                    <h3>${course.title}</h3>
                    <p>${course.description}</p>
                    <a href="${course.url}" class="btn-course" target="_blank" rel="noopener">
                        ✨ Quero Transformar Minha Vida
                    </a>
                </div>
            `;
        }

        function updateMetaTags(title, energyTitle) {
            const description = `Descubra como a ${energyTitle} influencia sua vida e como transformar seus resultados.`;
            const url = window.location.href;
            
            document.getElementById('pageDescription').content = description;
            document.getElementById('ogTitle').content = title;
            document.getElementById('ogDescription').content = description;
            
            // Atualizar URL do Open Graph se o elemento existir
            const ogUrl = document.getElementById('ogUrl');
            if (ogUrl) {
                ogUrl.content = url;
            }
        }

        // Funções de compartilhamento
        async function shareResult() {
            const userName = currentData.nome || 'Alguém especial';
            const energyTitle = currentResult.energyData.title;
            const url = window.location.href;
            
            const text = `🎯 ${userName} descobriu sua energia predominante: ${energyTitle}!\n\nFaça você também o Teste de Prosperidade e descubra qual energia move sua vida.\n\n✨ Meu resultado: ${url}\n🎯 Fazer o teste: ${CONFIG.testUrl}`;
            
            if (navigator.share && navigator.canShare && navigator.canShare({ text, url })) {
                try {
                    await navigator.share({
                        title: 'Meu Resultado - Teste de Prosperidade',
                        text: text,
                        url: url
                    });
                    return;
                } catch (err) {
                    if (err.name !== 'AbortError') {
                        console.log('Erro no Web Share API:', err);
                    }
                }
            }
            
            // Fallback para WhatsApp
            shareWhatsApp(text);
        }

        async function shareTest() {
            const text = `🎯 Descubra qual energia move sua vida!\n\nFiz o Teste de Prosperidade e foi revelador. Recomendo muito!\n\n✨ Faça você também: ${CONFIG.testUrl}`;
            
            if (navigator.share && navigator.canShare && navigator.canShare({ text, url: CONFIG.testUrl })) {
                try {
                    await navigator.share({
                        title: 'Teste de Prosperidade',
                        text: text,
                        url: CONFIG.testUrl
                    });
                    return;
                } catch (err) {
                    if (err.name !== 'AbortError') {
                        console.log('Erro no Web Share API:', err);
                    }
                }
            }
            
            // Fallback para WhatsApp
            shareWhatsApp(text);
        }

        function shareWhatsApp(text) {
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(whatsappUrl, '_blank', 'noopener,noreferrer');
        }

        // Geração de PDF
        function generatePDF() {
            if (!window.jsPDF) {
                alert('Erro ao carregar gerador de PDF. Recarregue a página e tente novamente.');
                return;
            }

            try {
                const { jsPDF } = window.jsPDF;
                const doc = new jsPDF();
                
                const userName = currentData.nome || 'Participante';
                const energyTitle = currentResult.energyData.title;
                const { percentages, counts, total } = currentResult;
                
                // Cabeçalho
                doc.setFontSize(20);
                doc.setFont(undefined, 'bold');
                doc.text('Resultado do Teste de Prosperidade', 20, 30);
                
                // Nome do usuário
                doc.setFontSize(16);
                doc.setFont(undefined, 'normal');
                doc.text(userName, 20, 45);
                
                // Informações do teste
                doc.setFontSize(10);
                doc.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`, 20, 55);
                doc.text(`UID: ${currentUID}`, 20, 62);
                doc.text(`Total de respostas: ${total}`, 20, 69);
                
                // Energia predominante
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('Energia Predominante:', 20, 85);
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                doc.text(energyTitle, 20, 95);
                
                // Distribuição das energias
                doc.setFont(undefined, 'bold');
                doc.text('Distribuição das Energias:', 20, 115);
                doc.setFont(undefined, 'normal');
                
                let yPos = 125;
                const energyLabels = {
                    prosperidade: 'Energia da Prosperidade',
                    medo: 'Energia do Medo',
                    autossuficiencia: 'Energia da Autossuficiência',
                    desordem: 'Energia da Desordem',
                    validacao: 'Energia da Validação'
                };
                
                Object.entries(energyLabels).forEach(([key, label]) => {
                    const percent = percentages[key] || 0;
                    const count = counts[key] || 0;
                    doc.text(`${label}: ${percent}% (${count}/${total})`, 25, yPos);
                    yPos += 8;
                });
                
                // URLs
                doc.setFontSize(10);
                doc.text('Acesse seu resultado online:', 20, 200);
                doc.text(window.location.href, 20, 208);
                
                doc.text('Compartilhe o teste:', 20, 220);
                doc.text(CONFIG.testUrl, 20, 228);
                
                // Rodapé
                doc.text('© 2024 Suellen Seragi - Teste de Prosperidade', 20, 280);
                
                // Salvar arquivo
                const fileName = `resultado-prosperidade-${userName.replace(/\s+/g, '-').toLowerCase()}-${currentUID}.pdf`;
                doc.save(fileName);
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                alert('Erro ao gerar PDF. Verifique sua conexão e tente novamente.');
            }
        }

        // Estados de loading e erro
        function showLoading() {
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('content').classList.add('hidden');
            document.getElementById('error').classList.add('hidden');
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('error').classList.remove('hidden');
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('content').classList.add('hidden');
        }

        // Tratamento de erros de imagem
        document.getElementById('headerLogo').addEventListener('error', function() {
            console.warn('Erro ao carregar logo do header');
            this.style.display = 'none';
        });

        // Otimização para performance
        window.addEventListener('load', function() {
            // Preload das imagens dos cursos
            const courseImages = [
                CONFIG.imagesPath + 'O%20Ouro%20Web.jpg',
                CONFIG.imagesPath + 'Lei%20da%20Atracao%20Editavel%20Web.jpg'
            ];
            
            courseImages.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        });
    </script>
</body>
</html>
